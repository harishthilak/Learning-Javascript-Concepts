<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h3> XMLHttpRequest Using Promise </h3>
    <button id = "btn"> Get Data </button>
    <div id="output"></div>
    <script>
         const btn = document.getElementById("btn");
         const output = document.getElementById("output");

         function loadfile(url){
            return new Promise((resolve,reject) => {
                const xhr = new XMLHttpRequest();
                xhr.open("GET",url,true);
                xhr.responseType = "json";
                xhr.onload = function(){
                    if (xhr.status === 200){
                        resolve(xhr.response);
                    } else {
                        reject(new Error(`Http Error : ${xhr.status} - ${xhr.statusText}`));
                    }
                };
                xhr.onerror = function(){
                    reject(new Error("Network Issue or Invalid Url"));
                };

                xhr.send();

            
            })

         }
         btn.addEventListener("click",() => {
            const url = "https://jsonplaceholder.typicode.com/posts";
            loadfile(url)
            .then ((data) => {
                console.log("Here We Go");
                output.innerHTML = '';
                //console.log(data);
                data.forEach((post) => {
                    output.innerHTML += `
                    <div>
                        <h4>${post.title}</h4>
                        <p>${post.body}</p>
                    </div>
                    `;

                });
                    
                });
            })
            .catch((error) => {
                console.error(error);
                output.innerHTML = `<p style="color:red;">${error.message}</p>`;
            });

        
         
    </script>
</body>
</html>